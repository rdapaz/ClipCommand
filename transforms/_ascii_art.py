#!/usr/bin/env python3
"""
_ascii_art.py — ASCII art rendering engine for ClipCommand.
Extracted from ascii_art.py (Ric de Paz).
Prefixed with _ so ClipCommand's transform scanner skips it.
"""

# ── BLOCK ─────────────────────────────────────────────────────────────────────
BLOCK = {
    'A': ["  ##  "," #### ","##  ##","######","##  ##","##  ##","##  ##"],
    'B': ["##### ","##  ##","##  ##","##### ","##  ##","##  ##","##### "],
    'C': [" #####","##    ","##    ","##    ","##    ","##    "," #####"],
    'D': ["####  ","##  ##","##  ##","##  ##","##  ##","##  ##","####  "],
    'E': ["######","##    ","##    ","####  ","##    ","##    ","######"],
    'F': ["######","##    ","##    ","####  ","##    ","##    ","##    "],
    'G': [" #####","##    ","##    ","## ###","##  ##","##  ##"," #####"],
    'H': ["##  ##","##  ##","##  ##","######","##  ##","##  ##","##  ##"],
    'I': ["######","  ##  ","  ##  ","  ##  ","  ##  ","  ##  ","######"],
    'J': ["######","    ##","    ##","    ##","##  ##","##  ##"," #### "],
    'K': ["##  ##","## ## ","####  ","###   ","####  ","## ## ","##  ##"],
    'L': ["##    ","##    ","##    ","##    ","##    ","##    ","######"],
    'M': ["##  ##","######","######","## ###","##  ##","##  ##","##  ##"],
    'N': ["##  ##","### ##","######","######","## ###","##  ##","##  ##"],
    'O': [" #### ","##  ##","##  ##","##  ##","##  ##","##  ##"," #### "],
    'P': ["##### ","##  ##","##  ##","##### ","##    ","##    ","##    "],
    'Q': [" #### ","##  ##","##  ##","##  ##","## ###","##  ##"," #####"],
    'R': ["##### ","##  ##","##  ##","##### ","####  ","## ## ","##  ##"],
    'S': [" #####","##    ","##    "," #### ","    ##","    ##","##### "],
    'T': ["######","  ##  ","  ##  ","  ##  ","  ##  ","  ##  ","  ##  "],
    'U': ["##  ##","##  ##","##  ##","##  ##","##  ##","##  ##"," #### "],
    'V': ["##  ##","##  ##","##  ##","##  ##"," #### ","  ##  ","  ##  "],
    'W': ["##  ##","##  ##","##  ##","## ###","######","######","##  ##"],
    'X': ["##  ##","##  ##"," #### ","  ##  "," #### ","##  ##","##  ##"],
    'Y': ["##  ##","##  ##"," #### ","  ##  ","  ##  ","  ##  ","  ##  "],
    'Z': ["######","    ##","   ## ","  ##  "," ##   ","##    ","######"],
    '0': [" #### ","##  ##","## ###","######","### ##","##  ##"," #### "],
    '1': [" ###  ","####  ","  ##  ","  ##  ","  ##  ","  ##  ","######"],
    '2': [" #### ","##  ##","    ##","  ### "," ##   ","##    ","######"],
    '3': [" #### ","##  ##","    ##","  ### ","    ##","##  ##"," #### "],
    '4': ["##  ##","##  ##","##  ##","######","    ##","    ##","    ##"],
    '5': ["######","##    ","##    ","##### ","    ##","##  ##"," #### "],
    '6': [" #### ","##    ","##    ","##### ","##  ##","##  ##"," #### "],
    '7': ["######","    ##","   ## ","  ##  "," ##   "," ##   "," ##   "],
    '8': [" #### ","##  ##","##  ##"," #### ","##  ##","##  ##"," #### "],
    '9': [" #### ","##  ##","##  ##"," #####","    ##","    ##"," #### "],
    '!': ["  ##  ","  ##  ","  ##  ","  ##  ","  ##  ","      ","  ##  "],
    '?': [" #### ","##  ##","    ##","  ### ","  ##  ","      ","  ##  "],
    '.': ["      ","      ","      ","      ","      "," ###  "," ###  "],
    ',': ["      ","      ","      ","      "," ###  "," ###  ","  ##  "],
    '-': ["      ","      ","      ","######","      ","      ","      "],
    ':': ["      "," ###  "," ###  ","      "," ###  "," ###  ","      "],
    ' ': ["      ","      ","      ","      ","      ","      ","      "],
}

# ── THIN ──────────────────────────────────────────────────────────────────────
THIN = {
    'A': ["  /\\  "," /  \\ ","/    \\","/----\\","|    |","|    |","|    |"],
    'B': ["|---\\ ","|   |\\","|   |/","|---/ ","|   |\\","|   |/","|---/ "],
    'C': [" /----","/     ","|     ","|     ","|     ","\\     "," \\----"],
    'D': ["|---\\ ","|   \\|","|    |","|    |","|    |","|   /|","|---/ "],
    'E': ["|-----","|     ","|     ","|---  ","|     ","|     ","|-----"],
    'F': ["|-----","|     ","|     ","|---  ","|     ","|     ","|     "],
    'G': [" /----","/     ","|     ","| ---+","|   ||","\\   ||"," \\---+"],
    'H': ["|    |","|    |","|    |","|----|","|    |","|    |","|    |"],
    'I': ["+----+","  ||  ","  ||  ","  ||  ","  ||  ","  ||  ","+----+"],
    'J': ["+-----","    | ","    | ","    | ","|   | ","\\   | "," \\--+ "],
    'K': ["|   /|","|  / |","| /  |","|<   |","| \\  |","|  \\ |","|   \\|"],
    'L': ["|     ","|     ","|     ","|     ","|     ","|     ","|-----"],
    'M': ["|\\  /|","| \\/ |","|    |","|    |","|    |","|    |","|    |"],
    'N': ["|\\   |","| \\  |","|  \\ |","|   \\|","|    |","|    |","|    |"],
    'O': [" /--\\ ","/    \\","|    |","|    |","|    |","\\    /"," \\--/ "],
    'P': ["|---\\ ","|   |\\","|   |/","|---/ ","|     ","|     ","|     "],
    'Q': [" /--\\ ","/    \\","|    |","|    |","|  \\ |","\\   \\|"," \\--\\/"],
    'R': ["|---\\ ","|   |\\","|   |/","|---/ ","| \\   ","|  \\  ","|   \\ "],
    'S': [" /----","/     ","\\     "," \\--\\ ","     \\","     /","----/ "],
    'T': ["+------+","   ||   ","   ||   ","   ||   ","   ||   ","   ||   ","   ||   "],
    'U': ["|    |","|    |","|    |","|    |","|    |","\\    /"," \\--/ "],
    'V': ["|    |","|    |","|    |"," \\  / ","  \\/  ","  /\\  "," /  \\ "],
    'W': ["|    |","|    |","|    |","|    |","| /\\ |","|/  \\|","/    \\"],
    'X': ["\\    /"," \\  / ","  \\/  ","  /\\  "," /  \\ ","/    \\","      "],
    'Y': ["|    |"," \\  / ","  \\/  ","  ||  ","  ||  ","  ||  ","  ||  "],
    'Z': ["+------+","      / ","     /  ","    /   ","   /    ","  /     ","+------+"],
    '0': [" /--\\ ","/  / |","| /  |","|/   |","|   \\|","|  \\ |"," \\--/ "],
    '1': ["  /|  "," / |  ","   |  ","   |  ","   |  ","   |  ","+--+--"],
    '2': [" /--\\ ","/    \\","     |","  --/ "," /    ","/     ","+-----"],
    '3': [" /--\\ ","     \\","     |"," ---/ ","     |","     /"," \\--/ "],
    '4': ["|    |","|    |","\\    |"," \\---+","     |","     |","     |"],
    '5': ["+-----+","|      ","|      ","+----\\ ","      |","      |","+----/ "],
    '6': [" /----","/     ","|     ","|---\\ ","|   | ","|   | "," \\--/ "],
    '7': ["+------+","      / ","     /  ","    /   ","   /    ","  /     "," /      "],
    '8': [" /--\\ ","/    \\","\\    /"," \\--/ ","/    \\","\\    /"," \\--/ "],
    '9': [" /--\\ ","/    \\","|    |"," \\---+","     |","     |"," \\---+"],
    '!': ["  ||  ","  ||  ","  ||  ","  ||  ","  ||  ","      ","  /\\  "],
    '?': [" /--\\ ","/    \\","     |","   --/","  ||  ","      ","  /\\  "],
    '.': ["      ","      ","      ","      ","      ","  /\\  ","  \\/  "],
    ',': ["      ","      ","      ","      ","  /\\  ","  \\/  ","  /   "],
    '-': ["      ","      ","      ","+----+","      ","      ","      "],
    ':': ["      ","  /\\  ","  \\/  ","      ","  /\\  ","  \\/  ","      "],
    ' ': ["      ","      ","      ","      ","      ","      ","      "],
}

# ── DOUBLE ────────────────────────────────────────────────────────────────────
DOUBLE = {
    'A': ['  ##  ',' #  # ','#    #','######','#    #','#    #','#    #'],
    'B': ['##### ','#    #','#    #','##### ','#    #','#    #','##### '],
    'C': [' #####','#     ','#     ','#     ','#     ','#     ',' #####'],
    'D': ['####  ','#   ##','#    #','#    #','#    #','#   ##','####  '],
    'E': ['######','#     ','#     ','####  ','#     ','#     ','######'],
    'F': ['######','#     ','#     ','####  ','#     ','#     ','#     '],
    'G': [' #####','#     ','#     ','#  ###','#    #','#    #',' #####'],
    'H': ['#    #','#    #','#    #','######','#    #','#    #','#    #'],
    'I': ['######','  ##  ','  ##  ','  ##  ','  ##  ','  ##  ','######'],
    'J': ['######','     #','     #','     #','#    #','#    #',' #### '],
    'K': ['#    #','#   # ','#  #  ','## ## ','#  #  ','#   # ','#    #'],
    'L': ['#     ','#     ','#     ','#     ','#     ','#     ','######'],
    'M': ['#     #','##   ##','# # # #','#  #  #','#     #','#     #','#     #'],
    'N': ['#    #','##   #','# #  #','#  # #','#   ##','#    #','#    #'],
    'O': [' #### ','#    #','#    #','#    #','#    #','#    #',' #### '],
    'P': ['##### ','#    #','#    #','##### ','#     ','#     ','#     '],
    'Q': [' #### ','#    #','#    #','#    #','#  ## ','#   # ',' #### '],
    'R': ['##### ','#    #','#    #','##### ','# #   ','#  #  ','#   # '],
    'S': [' #####','#     ','#     ',' #### ','     #','     #','##### '],
    'T': ['######','  ##  ','  ##  ','  ##  ','  ##  ','  ##  ','  ##  '],
    'U': ['#    #','#    #','#    #','#    #','#    #','#    #',' #### '],
    'V': ['#    #','#    #','#    #','#    #',' #### ','  ##  ','  ##  '],
    'W': ['#     #','#     #','#     #','#  #  #','# # # #','##   ##','#     #'],
    'X': ['#    #',' #  # ','  ##  ','  ##  ','  ##  ',' #  # ','#    #'],
    'Y': ['#    #',' #  # ','  ##  ','  ##  ','  ##  ','  ##  ','  ##  '],
    'Z': ['######','    # ','   #  ','  ##  ',' #    ','#     ','######'],
    '0': [' #### ','#    #','# ## #','# ## #','# ## #','#    #',' #### '],
    '1': [' ### ','## # ','   # ','   # ','   # ','   # ','#####'],
    '2': [' #### ','#    #','     #','  ### ',' #    ','#     ','######'],
    '3': [' #### ','#    #','     #','  ### ','     #','#    #',' #### '],
    '4': ['#    #','#    #','#    #','######','     #','     #','     #'],
    '5': ['######','#     ','#     ','######','     #','     #','######'],
    '6': [' #### ','#     ','#     ','######','#    #','#    #',' #### '],
    '7': ['######','     #','    # ','   #  ','  #   ',' #    ','#     '],
    '8': [' #### ','#    #','#    #',' #### ','#    #','#    #',' #### '],
    '9': [' #### ','#    #','#    #',' #####','     #','     #',' #### '],
    '!': ['  ##  ','  ##  ','  ##  ','  ##  ','  ##  ','      ','  ##  '],
    '?': [' #### ','#    #','     #','  ### ','  ##  ','      ','  ##  '],
    '.': ['      ','      ','      ','      ','      ','  ##  ','  ##  '],
    ',': ['      ','      ','      ','      ','  ##  ','  ##  ','  #   '],
    '-': ['      ','      ','      ','######','      ','      ','      '],
    ':': ['      ','  ##  ','  ##  ','      ','  ##  ','  ##  ','      '],
    ' ': ['       ','       ','       ','       ','       ','       ','       '],
}

# ── SMALL ─────────────────────────────────────────────────────────────────────
SMALL = {
    'A': [' /\\ ','/--\\','/  \\'], 'B': ['|=> ','|=> ','|=> '],
    'C': [' /-\\','|   ',' \\-/'], 'D': ['|\\  ','| \\ ','|/  '],
    'E': ['|===','|=  ','|==='], 'F': ['|===','|=  ','|   '],
    'G': [' /-\\','| =-',' \\-/'], 'H': ['|  |','|==|','|  |'],
    'I': ['===', ' | ', '==='], 'J': ['  |','  |','\\_/'],
    'K': ['|\\  ','|/  ','|\\  '], 'L': ['|  ','|  ','|=='],
    'M': ['|V|','| |','| |'], 'N': ['|\\ ','| \\','|  '],
    'O': [' _ ','| |',' - '], 'P': ['|==|','|== ','|   '],
    'Q': [' _  ','|\\  ',' \\- '], 'R': ['|==|','|=/ ','|\\  '],
    'S': [' /-\\',' \\-\\','/-/ '], 'T': ['===', ' | ', ' | '],
    'U': ['|  |','|  |',' -- '], 'V': ['|  |',' \\/ ','  | '],
    'W': ['| |','|V|','/ \\'], 'X': ['\\ /',' X ','/ \\'],
    'Y': ['\\ /', ' | ', ' | '], 'Z': ['=\\ ',' \\ ','=/ '],
    '0': [' 0 ','|0|',' 0 '], '1': [' 1 ',' 1 ',' 1 '],
    '2': ['-2 ',' / ','/2-'], '3': ['-3 ','-3 ','-3 '],
    '4': ['| |','|=|','  |'], '5': ['|= ',' \\-','-/ '],
    '6': [' /=','|\\ ',' \\='], '7': ['=7 ',' / ','/  '],
    '8': [' 8 ','-8-',' 8 '], '9': [' 9 ','\\_|',' 9 '],
    '!': ['!','!','.'], '?': ['?',' ','?'],
    '.': [' ',' ','.'], ',': [' ',' ',','],
    '-': [' ','-',' '], ':': ['.',' ','.'],
    ' ': ['  ','  ','  '],
}

# ── BANNER ────────────────────────────────────────────────────────────────────
BANNER = {
    'A': ['   /\\    ','  /  \\   ',' / /\\ \\  ','/______\\ ','| |  | | ','| |  | | ','| |  | | ','|_|  |_| ','         '],
    'B': ['______   ','| ___ \\  ','| |_/ /  ','| ___ \\  ','| |_/ /  ','|____/   ','         ','         ','         '],
    'C': [' _____  ','/  __ \\ ','| /  \\/ ','| |     ','| \\__/\\ ',' \\____/ ','        ','        ','        '],
    'D': ['______   ','|  _  \\  ','| | | |  ','| | | |  ','| |/ /   ','|___/    ','         ','         ','         '],
    'E': [' _____  ','|  ___| ','| |__   ','|  __|  ','| |___  ','\\____/  ','        ','        ','        '],
    'F': [' _____  ','|  ___| ','| |_    ','|  _|   ','| |     ','\\_|     ','        ','        ','        '],
    'G': [' _____  ','|  __ \\ ','| |  \\/ ','| | __  ','| |_\\ \\ ',' \\____/ ','        ','        ','        '],
    'H': [' _   _  ','| | | | ','| |_| | ','|  _  | ','| | | | ','\\_| |_/ ','        ','        ','        '],
    'I': [' ___ ','|_ _|',' | | ',' | | ',' | | ','|___|','     ','     ','     '],
    'J': ['   _  ','  | | ','  | | ','  | | ',' _| | ','|__/  ','      ','      ','      '],
    'K': [' _   __ ','| | / / ','| |/ /  ','|    \\  ','| |\\  \\ ','\\_| \\_/ ','        ','        ','        '],
    'L': [' _      ','| |     ','| |     ','| |     ','| |___  ','\\_____/ ','        ','        ','        '],
    'M': [' ___ ___  ','|  \\/  |  ','| .  . |  ','| |\\/| |  ','| |  | |  ','\\_|  |_/  ','          ','          ','          '],
    'N': [' _   _  ','| \\ | | ','|  \\| | ','| . ` | ','| |\\  | ','\\_| \\_/ ','        ','        ','        '],
    'O': ['  ___   ',' / _ \\  ','| | | | ','| | | | ','| |_| | ',' \\___/  ','        ','        ','        '],
    'P': [' ____   ','|  _ \\  ','| |_) | ','|  __/  ','| |     ','|_|     ','        ','        ','        '],
    'Q': ['  ___   ',' / _ \\  ','| | | | ','| | | | ','| |_| | ',' \\__\\_\\ ','        ','        ','        '],
    'R': [' ____   ','|  _ \\  ','| |_) | ','|  _ <  ','| |_) | ','|____/  ','        ','        ','        '],
    'S': ['  ____  ',' / ___| ',' \\___ \\ ','  ___) |',' /____/ ','        ','        ','        ','        '],
    'T': [' _____  ','|_   _| ','  | |   ','  | |   ','  | |   ','  \\_/   ','        ','        ','        '],
    'U': [' _   _  ','| | | | ','| | | | ','| | | | ','| |_| | ',' \\___/  ','        ','        ','        '],
    'V': ['__   __ ','\\ \\ / / ',' \\ V /  ','  \\ /   ','   V    ','   |    ','        ','        ','        '],
    'W': ['__      __ ','\\ \\    / / ',' \\ \\  / /  ','  \\ \\/ /   ','   \\__/    ','           ','           ','           ','           '],
    'X': ['__  __ ','\\ \\/ / ',' >  <  ','/ /\\ \\ ','/_/\\_\\ ','       ','       ','       ','       '],
    'Y': ['__   __ ','\\ \\ / / ',' \\ Y /  ','  \\ /   ','  | |   ','  |_|   ','        ','        ','        '],
    'Z': [' ____   ','|_  /   ',' / /    ','/ /_    ','/____\\  ','        ','        ','        ','        '],
    '0': ['  ___   ',' / _ \\  ','| | | | ','| |/| | ','|  _| | ',' \\___/  ','        ','        ','        '],
    '1': ['  _   ',' /|   ','  |   ','  |   ','  |   ',' _|_  ','      ','      ','      '],
    '2': [' ___  ','|_  / ',' / /  ','/ /   ','/__/  ','      ','      ','      ','      '],
    '3': [' ___  ','|_  ) ',' / /  ','/ /_  ','/____|','      ','      ','      ','      '],
    '4': ['  _ _  ',' | | | ',' |_  | ','   | | ','   |_| ','       ','       ','       ','       '],
    '5': [' ___ ','| __|','|__ \\', ' ___)', '|___/','     ','     ','     ','     '],
    '6': ['  _  ',' / / ','/ _ \\','\\_, /',' /_/ ','     ','     ','     ','     '],
    '7': [' ___  ','( _ ) ','/ _ \\ ','\\_, / ',' /_/  ','      ','      ','      ','      '],
    '8': [' ___  ','( _ ) ','/ _ \\ ','\\_, / ',' /_/  ','      ','      ','      ','      '],
    '9': ['  _   ',' / /  ','/ _ \\ ','\\_, / ',' /_/  ','      ','      ','      ','      '],
    '!': [' _  ','| | ','| | ','| | ','|_| ','    ',' _  ','(_) ','    '],
    '?': [' __  ','|_ \\ ','  ) |',' / / ','|_|  ','     ',' _   ','(_)  ','     '],
    '.': ['   ','   ','   ','   ',' _ ','(_)','   ','   ','   '],
    ',': ['    ','    ','    ',' _  ','( ) ','|/  ','    ','    ','    '],
    '-': ['   ','   ','   ','___','   ','   ','   ','   ','   '],
    ':': ['   ',' _ ','(_)','   ',' _ ','(_)','   ','   ','   '],
    ' ': ['   ','   ','   ','   ','   ','   ','   ','   ','   '],
}

# ── RETRO ─────────────────────────────────────────────────────────────────────
RETRO = {
    'A': [" .#. ","#.#.#","#####","#...#","#...#"],
    'B': ["####.","#...#","####.","#...#","####."],
    'C': [".####","#....","#....","#....",".####"],
    'D': ["###..","#..#.","#...#","#..#.","###.."],
    'E': ["#####","#....","####.","#....","#####"],
    'F': ["#####","#....","####.","#....","#...."],
    'G': [".####","#....","#.###","#...#",".####"],
    'H': ["#...#","#...#","#####","#...#","#...#"],
    'I': ["###",".#.",".#.",".#.","###"],
    'J': [".####","....#","....#","#...#",".###."],
    'K': ["#..#.","#.#..","##...","#.#..","#..#."],
    'L': ["#....","#....","#....","#....","#####"],
    'M': ["#...#","##.##","#.#.#","#...#","#...#"],
    'N': ["#...#","##..#","#.#.#","#..##","#...#"],
    'O': [".###.","#...#","#...#","#...#",".###."],
    'P': ["####.","#...#","####.","#....","#...."],
    'Q': [".###.","#...#","#.#.#","#..#.",".##.#"],
    'R': ["####.","#...#","####.","#.#..","#..#."],
    'S': [".####","#....","..###","....#","####."],
    'T': ["#####","..#..","..#..","..#..","..#.."],
    'U': ["#...#","#...#","#...#","#...#",".###."],
    'V': ["#...#","#...#","#...#",".#.#.","..#.."],
    'W': ["#...#","#...#","#.#.#","##.##","#...#"],
    'X': ["#...#",".#.#.","..#..",".#.#.","#...#"],
    'Y': ["#...#",".#.#.","..#..","..#..","..#.."],
    'Z': ["#####","...#.","..#..",".#...","#####"],
    '0': [".###.","#.#.#","#.#.#","#.#.#",".###."],
    '1': [".##.","..#.","..#.","..#.","####"],
    '2': [".###.","....#",".###.","#....","#####"],
    '3': ["#####","....#",".####","....#","#####"],
    '4': ["#...#","#...#","#####","....#","....#"],
    '5': ["#####","#....","#####","....#","#####"],
    '6': [".####","#....","####.","#...#",".###."],
    '7': ["#####","....#","...#.","..#..","..#.."],
    '8': [".###.","#...#",".###.","#...#",".###."],
    '9': [".###.","#...#",".####","....#","####."],
    '!': [".#.",".#.",".#.","...",".#."],
    '?': ["###.","...#",".##.","....","..#."],
    '.': ["...","...","...","...",".#."],
    ',': ["...","...","...",".#.","##."],
    '-': [".....",".....",  "#####",".....","....."],
    ':': [".","."," ",".","." ],
    ' ': ["   ","   ","   ","   ","   "],
}


# ── Shadow builder ────────────────────────────────────────────────────────────
def _build_shadow():
    result = {}
    for char, rows in BLOCK.items():
        h, w = len(rows), len(rows[0])
        oh, ow = h + 2, w + 2
        grid = [[' '] * ow for _ in range(oh)]
        for r in range(h):
            for c in range(w):
                if rows[r][c] == '#':
                    sr, sc = r + 2, c + 2
                    if sr < oh and sc < ow and grid[sr][sc] == ' ':
                        grid[sr][sc] = '.'
        for r in range(h):
            for c in range(w):
                if rows[r][c] == '#':
                    grid[r][c] = '#'
        result[char] = [''.join(row) for row in grid]
    return result


def _unicode(charset, fg='#', fg_u='\u2588', shadow=None, shadow_u='\u2591'):
    out = {}
    for ch, rows in charset.items():
        new = [r.replace(fg, fg_u) for r in rows]
        if shadow:
            new = [r.replace(shadow, shadow_u) for r in new]
        out[ch] = new
    return out


_SHADOW_RAW = _build_shadow()

STYLES = {
    'block':  _unicode(BLOCK),
    'shadow': _unicode(_SHADOW_RAW, shadow='.', shadow_u='\u2591'),
    'thin':   THIN,
    'double': _unicode(DOUBLE),
    'small':  SMALL,
    'banner': BANNER,
    'retro':  RETRO,
}

STYLE_NAMES = sorted(STYLES.keys())

STYLE_DESCRIPTIONS = {
    'block':  'Bold filled Unicode block characters',
    'shadow': 'Block style with a drop-shadow',
    'thin':   'Skeletal single-line stroke style',
    'double': 'Double-line box-drawing characters',
    'small':  'Compact 3-row ASCII style',
    'banner': 'Tall proportional letter forms',
    'retro':  'Dot-matrix inspired 5-row style',
}


# ── Validation ────────────────────────────────────────────────────────────────
def _validate():
    errors = []
    for sname, charset in STYLES.items():
        for char, rows in charset.items():
            widths = [len(r) for r in rows]
            if len(set(widths)) > 1:
                errors.append(f"  Style '{sname}', char {char!r}: widths {widths}")
    if errors:
        raise ValueError("Inconsistent glyph widths:\n" + "\n".join(errors))

_validate()


# ── Renderer ──────────────────────────────────────────────────────────────────
def render(text: str, style_name: str = 'block', char_spacing: int = 1) -> list:
    """
    Render text as ASCII art. Returns list of strings (one per output row).
    Raises ValueError for unknown style.
    """
    style_name = style_name.lower()
    if style_name not in STYLES:
        raise ValueError(
            f"Unknown style '{style_name}'. Available: {', '.join(STYLE_NAMES)}"
        )
    charset = STYLES[style_name]
    glyphs  = []
    for ch in text:
        key = ch.upper() if ch.upper() in charset else (ch if ch in charset else None)
        glyphs.append(charset[key] if key else charset[' '])

    if not glyphs:
        return []

    height = max(len(g) for g in glyphs)
    padded = []
    for g in glyphs:
        if len(g) < height:
            g = g + [' ' * len(g[0])] * (height - len(g))
        padded.append(g)

    gap = ' ' * char_spacing
    return [gap.join(g[i] for g in padded) for i in range(height)]
